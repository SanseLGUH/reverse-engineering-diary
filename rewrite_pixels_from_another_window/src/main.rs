use windows::{ core::*,
    Win32::Foundation::*, Win32::Graphics::Gdi::*,
    Win32::UI::WindowsAndMessaging::*
};

fn draw(hwnd: HWND) {
    unsafe {
        
        let color = COLORREF(0x0000FF);
        let mut window_size = RECT::default();

        loop {
            if let Ok(_) = GetClientRect(hwnd, &mut window_size) {
                let rect = RECT {
                    left: 0,
                    top: 0,
                    right: window_size.right,
                    bottom: window_size.bottom,
                };

                let hdc = GetDC(Some(hwnd));
                let brush = CreateSolidBrush(color);

                FillRect(hdc, &rect, brush);

                if !DeleteObject(HGDIOBJ::from(brush)).as_bool() {
                    println!("Resource leak prevented");
                    break;
                }
                ReleaseDC(Some(hwnd), hdc);
            }
        }
    }
}

fn main() {
    unsafe {
        // choose window you want to rewrite 
        if let Ok(hwnd) = FindWindowA(None, PCSTR(b"Tlauncher 2.9307\0".as_ptr())) {
            draw(hwnd);
        }
    }
}

/*
‚ùì–•–æ—á–µ—à—å –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –ø–æ–≤–µ—Ä—Ö —á—É–∂–æ–≥–æ –æ–∫–Ω–∞, –∫–∞–∫ –æ–≤–µ—Ä–ª–µ–π?
–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –¥–µ–ª–∞—Ç—å "–æ–≤–µ—Ä–ª–µ–π" ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∏—Å–æ–≤–∞—Ç—å –ø–æ–≤–µ—Ä—Ö –æ–∫–Ω–∞ –∏–≥—Ä—ã, –±—Ä–∞—É–∑–µ—Ä–∞ –∏ —Ç.–ø., —Ç–æ:

–û–±—ã—á–Ω–æ —Å–æ–∑–¥–∞—é—Ç —Å–≤–æ—ë –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–≤–µ—Ä—Ö –Ω—É–∂–Ω–æ–≥–æ –æ–∫–Ω–∞ (—á–µ—Ä–µ–∑ WS_EX_LAYERED, WS_EX_TRANSPARENT).

–ò–ª–∏ —Ä–∏—Å—É—é—Ç –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ GetDC(hwnd).

–ú–æ–≥—É –ø–æ–º–æ—á—å —Å–æ–∑–¥–∞—Ç—å —Ç–∞–∫–æ–π –æ–≤–µ—Ä–ª–µ–π –∏–ª–∏ –æ–±—ä—è—Å–Ω–∏—Ç—å, –∫–∞–∫ —Ä–∏—Å–æ–≤–∞—Ç—å "–ø—Ä–∞–≤–∏–ª—å–Ω–æ" –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ.
*/


/*
‚ùå –û—à–∏–±–∫–∞:
// –ù–µ–ª—å–∑—è —Ç–∞–∫ –¥–µ–ª–∞—Ç—å ‚Äî —ç—Ç–æ —á—É–∂–æ–µ –æ–∫–Ω–æ!
let hdc = BeginPaint(hwnd, &mut ps);  // ‚ùå

‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
let hdc = GetDC(Some(hwnd));          // ‚úÖ –ü–æ–ª—É—á–∏–ª–∏ DC —á—É–∂–æ–≥–æ –æ–∫–Ω–∞
FillRect(hdc, &rect, brush);          // ‚úÖ –ù–∞—Ä–∏—Å–æ–≤–∞–ª–∏
ReleaseDC(Some(hwnd), hdc);           // ‚úÖ –û—Å–≤–æ–±–æ–¥–∏–ª–∏ DC

üß† –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?
–û–∫–Ω–∞ –≤ Windows –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–≤–æ–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. 
–ö–æ–≥–¥–∞ –≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç–µ BeginPaint, –≤—ã –≥–æ–≤–æ—Ä–∏—Ç–µ: "–Ø ‚Äî –≤–ª–∞–¥–µ–ª–µ—Ü –æ–∫–Ω–∞, –∏ —Å–µ–π—á–∞—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é WM_PAINT". 
–ù–æ –µ—Å–ª–∏ –æ–∫–Ω–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥—Ä—É–≥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É ‚Äî –≤—ã –Ω–µ –∏–º–µ–µ—Ç–µ –ø—Ä–∞–≤–∞ —Ç–∞–∫ –¥–µ–ª–∞—Ç—å. 
–≠—Ç–æ –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –æ–∫–Ω–∞ –∏ —Å–∏—Å—Ç–µ–º—ã.
*/

/*
üîç –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç WS_EX_LAYERED:
–≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Å—Ç–∏–ª—è –æ–∫–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç:

—Ä–∏—Å–æ–≤–∞—Ç—å —Å –∞–ª—å—Ñ–∞-–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é (–≤–∫–ª—é—á–∞—è –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏)

–¥–µ–ª–∞—Ç—å –æ–∫–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º

–æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –æ–∫–Ω–æ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –º—ã—à—å (WS_EX_TRANSPARENT)
*/ 